2 GOTO654
4 REM
6 REM
10 REM
12 REM
14 REM
16 CLEAR 5500:DIM A$(50),B$(50),C$(50),D$(50),E$(50)
18 CLS3
20 S$=" "+STRING$(30,"*"):R$=STRING$(80,"*"):U$=" *"+STRING$(28," ")+"*"
22 FORX=1to50
24 PRINT@160,S$:PRINT@192,"            FILE IT"
26 PRINT@224,"     DATA MANAGEMENT PROGRAM"
28 PRINT@256,"         BY KEITH BAKER"
30 PRINT@288,S$
32 NEXTX
34 CLS:PRINT@224,"      LOAD AN EXISTING FILE?":PRINT@256,"PRESS <Y> FOR YES OR <N> FOR NO."
36 L$=INKEY$:IF L$="" THEN 36
38 IF L$="y" OR L$="Y" THEN 542
40 IF L$="n" OR L$="N" THEN 44
42 GOTO 36
44 CLS:PRINT"    FIELD NAMING FUNCTION":PRINT:PRINT
46 LINEINPUT"FIELD 1 NAME:";BA$
48 LINEINPUT"FIELD 2 NAME:";BB$
50 LINEINPUT"FIELD 3 NAME:";BC$
52 LINEINPUT"FIELD 4 NAME:";BD$
54 LINEINPUT"FIELD 5 NAME:";BE$
56 CLS3:PRINT@96,S$:PRINT U$
58 PRINT" *    1> FILE MAINTAINCE      *"
60 PRINT" *    2> SEARCH FILE          *"
62 PRINT" *    3> SORT FILE            *"
64 PRINT" *    4> SAVE FILE            *"
66 PRINT" *    5> PRINT FILE           *"
68 PRINT" *    6> VIEW FILE            *"
70 PRINTU$:PRINTS$:PRINT"   "REC" FILE/S NOW IN MEMORY":SOUND220,1
72 L$=INKEY$:IFL$=""THEN72
74 L=VAL(L$)
76 IF L<1 OR L>6 THEN 72 ELSE 78
78 ON L GOTO 80,254,424,516,588,620
80 REM FILE MAINTAINCE
82 CLS3:PRINT@160,S$:PRINTU$
84 PRINT" *    1> ADD FILE             *"
86 PRINT" *    2> DELETE FILE          *"
88 PRINT" *    3> EDIT FILE            *"
90 PRINT" *    R> RETURN MAIN MENU     *"
92 PRINT U$:PRINT S$
94 SOUND 220,1
96 L$=INKEY$:IF L$="" THEN 96
98 IF L$="r" OR L$="R" THEN 56
100 L=VAL(L$)
102 IF L=1 OR L=2 OR L=3 THEN 104 ELSE 96
104 CLS:ON L GOTO 106,160,200
106 REM ADD A LISTING
108 REC=REC+1
110 CLS1:PRINTS$
112 PRINT" *        ADD A FILE          *"
114 PRINTS$
116 PRINT"        FILE NUMBER:"REC:PRINT
118 PRINT"ENTER "BA$" :";:LINEINPUT A$(REC)
120 PRINT"ENTER "BB$" :";:LINEINPUT B$(REC)
122 PRINT"ENTER "BC$" :";:LINEINPUT C$(REC)
124 PRINT"ENTER "BD$" :";:LINEINPUT D$(REC)
126 PRINT"ENTER "BE$" :";:LINEINPUT E$(REC)
128 CLS
130 PRINT"        FILE NUMBER:"REC:PRINT
132 PRINT BA$" :"A$(REC)
134 PRINT BB$" :"B$(REC)
136 PRINT BC$" :"C$(REC)
138 PRINT BD$" :"D$(REC)
140 PRINT BE$" :"E$(REC)
142 PRINT:PRINT"IS THIS CORRECT(y/n)"
144 AN$=INKEY$:IF AN$="" THEN 144
146 IF AN$="y" OR AN$="Y" THEN 150
148 IF AN$="n" OR AN$="N" THEN RN=REC:CLS:GOTO 220
150 CLS3:PRINT@192,"  INPUT <A> ANOTHER OR                   <R> RETURN TO MENU"
152 L$=INKEY$:IF L$="" THEN 152
154 IF L$="a" OR L$="A" THEN REC=REC+1:GOTO110
156 IF L$="r" OR L$="R" THEN 56
158 GOTO 152
160 REM DELETE A FILE
162 CLS(7):PRINT@0,"ENTER <R> TO RETURN TO MAIN MENU":PRINT@192,S$
164 PRINT" *        DELETE A FILE       *"
166 PRINT S$
168 PRINT:INPUT" FILE NUMBER TO BE DELETED:";RN$
170 IF RN$="R" OR RN$="r" THEN 56 ELSE 172
172 RN=VAL(RN$):IF RN>REC OR RN<1 THEN 162
174 CLS:PRINT@32,"          DELETE FUNCTION":GOSUB 574
176 PRINT" CORRECT LISTING (y/n)"
178 L$=INKEY$:IF L$="" THEN 178
180 IF L$="y" OR L$="Y" THEN 188
182 IF L$="n" OR L$="N" THEN 160
184 IF L$="r" OR L$="R" THEN 56
186 GOTO 178
188 A$(RN)=A$(RN-RN):B$(RN)=B$(RN-RN):C$(RN)=C$(RN-RN):D$(RN)=D$(RN-RN):E$(RN)=E$(RN-RN)
190 CLS:FOR X=1TO100:PRINT@232,"RECORD DELETED":NEXT X:FOR X=RN TO REC
192 A$(X)=A$(X+1):B$(X)=B$(X+1):C$(X)=C$(X+1):D$(X)=D$(X+1):E$(X)=E$(X+1)
194 NEXT X
196 REC=REC-1:IF REC<1 THEN REC=0
198 GOTO 56
200 REM EDIT A FILE
202 CLS7:PRINT@0,"ENTER <R> TO RETURN TO MAIN MENU":PRINT@192,S$
204 PRINT" *         EDIT A FILE        *"
206 PRINT S$
208 PRINT:INPUT" FILE NUMBER TO BE EDITED:":RN$
210 IF RN$="R" OR RN$="r" THEN 56 ELSE 212
212 RN=VAL(RN$):IF RN<1 OR RN>REC THEN 214 ELSE 218
214 CLS:FOR X=1 TO 100:PRINT@256,"   RECORD NUMBER OUT OF RANGE":NEXT X
216 GOTO 56
218 CLS:PRINT@32,"            EDIT FUNCTION"
220 GOSUB 574
222 PRINT"      EDIT WHICH FIELD ?"
224 L$=INKEY$:IF L$="" THEN 224
226 IF L$="r" or L$="R" THEN 56
228 L=VAL(L$): IF L<1 OR L>5 THEN 224 ELSE 230
230 CLS:ON L GOTO 232,234,236,238,240
232 PRINT BA$" :"A$(RN):PRINT:LINEINPUT"CHANGE TO: ";A$(RN):GOTO242
234 PRINT BB$" :"B$(RN):PRINT:LINEINPUT"CHANGE TO: ";B$(RN):GOTO242
236 PRINT BC$" :"C$(RN):PRINT:LINEINPUT"CHANGE TO: ";C$(RN):GOTO242
238 PRINT BD$" :"D$(RN):PRINT:LINEINPUT"CHANGE TO: ";D$(RN):GOTO242
240 PRINT BE$" :"E$(RN):PRINT:LINEINPUT"CHANGE TO: ";E$(RN):GOTO242
242 CLS:GOSUB 574
244 PRINT"IS THIS CORRECT (y/n)?"
246 L$=INKEY$:IF L$="" THEN 246
248 IF L$="y" OR L$="r" OR L$="Y" OR L$="R" THEN 56
250 IF L$="n" OR L$="N" THEN CLS:GOTO 222
252 GOTO 246
254 REM SEARCH ROUTINE
256 CLS0:PRINT@128,S$,PRINT U$
258 PRINT"    1> SEARCH BY "BA$
260 PRINT"    2> SEARCH BY "BB$
262 PRINT"    3> SEARCH BY "BC$
264 PRINT"    4> SEARCH BY "BD$
266 PRINT"    5> RETURN TO MENU"
268 PRINT U$:PRINT S$: SOUND 220,1
270 L$=INKEY$:IF L$="" THEN 270
272 IF L$="r" OR L$="R" THEN 56
274 L=VAL(L$)
276 IF L<1 OR L>4 THEN 270 ELSE 278
278 CLS:ON L GOTO 280,316,352,388
280 REM SEARCH
282 CLS:PRINT S$
284 PRINT"      SEARCH FOR "BA$
286 PRINT S$
288 PRINT"ENTER "BA$" FOR SEARCH":LINEINPUT SR$
290 M=0:N=0:FOR RN=N TO REC:IF SR$=A$(RN) THEN 292 ELSE 294
292 M=M+1
294 NEXT RN
296 CLS1:FOR RN=N TO REC:PRINT@32,"        SEARCH FUNCTION"
298 IF SR$=A$(RN) THEN GOSUB 574 ELSE 312
300 PRINT"THERE IS/ARE "M" FILE/S MEETING YOUR SPECIFICATIONS. IS THIS   THE ONE YOU WANT <y/n>?"
302 L$=INKEY$:IF L$="" THEN 302
304 IF L$="n" OR L$="N" THEN 312
306 IF L$="r" OR L$="R" THEN 56
308 IF L$="y" OR L$="Y" THEN GOSUB 652
310 GOTO 302
312 NEXT RN
314 CLS:PRINT@201,"FILE NOT FOUND":FOR X=1 TO 300:NEXT X:GOTO56
316 REM SEARCH
318 CLS:PRINT S$
320 PRINT "      SEARCH FOR "BB$
322 PRINT S$
324 PRINT"ENTER "BB$" FOR SEARCH":LINEINPUT SR$
326 M=0:N=0:FOR RN=N TO REC:IF SR$=B$(RN) THEN 328 ELSE 330
328 M=M+1
330 NEXT RN
332 CLS1:FOR RN=N TO REC:PRINT@32,"        SEARCH FUNCTION"
334 IF SR$=B$(RN) THEN GOSUB 574 ELSE 348
336 PRINT"THERE IS/ARE "M" FILE/S MEETING YOUR SPECIFICATIONS. IS THIS THE ONE YOU WANT <y/n>?"
338 L$=INKEY$:IF L$="" THEN 338
340 IF L$="n" OR L$="N" THEN 348
342 IF L$="y" OR L$="Y" GOSUB 652
344 IF L$="r" OR L$="R" THEN 56
346 GOTO 338
348 NEXT RN
350 CLS:PRINT@201,"FILE NOT FOUND":FOR X=1 TO 500:NEXT X:GOTO 56
352 REM SEARCH
354 CLS:PRINT S$
356 PRINT"      SEARCH FOR "BC$
358 PRINT S$
360 PRINT"EENTER "BC$" FOR SEARCH":LINEIPUT SR$
362 M=0:N=0:FOR RN=N TO REC:IF SR$=C$(RN) THEN 364 ELSE 366
364 M=M+1
366 NEXT RN:CLS1:FOR RN=N TO REC
368 PRINT@32,"         SEARCH FUNCTION"
370 IF SR$=C$(RN) THEN GOSUB 574 ELSE 384
372 PRINT"THERE IS/ARE "M" FILE/S MEETING YOUR SPECIFICATIONS. IS THIS THE ONE YOU WANT <y/n>?"
374 L$=INKEY$:IF L$="" THEN 374
376 IF L$="n" OR L$="N" THEN 384
378 IF L$="r" OR L$="R" THEN 56
380 IF L$="y" OR L$="Y" GOSUB 652
382 GOTO 374
384 NEXT RN
386 CLS:PRINT@201,"FILE NOT FOUND":FOR X=1 TO 500:NEXT X:GOTO 36
388 REM SEARCH
390 CLS:PRINT S$
392 PRINT"      SEARCH FOR "BD$
394 PRINT S$
396 PRINT"ENTER "BD$" FOR SEARCH":LINEINPUT SR$
398 M=0:N=0:FOR RN=N TO REC:IF SR$=D$(RN) THEN 400 ELSE 402
400 M=M+1
402 NEXT RN
404 CLS:FOR RN=N TO REC:PRINT@32,"         SEARCH FUNCTION"
406 IF SR$=D$(RN) THEN GOSUB 574 ELSE 420
408 PRINT"THERE IS/ARE "M" FILE/S MEETING YOUR SPECIFICATIONS. IS THIS THEONE YOU WANT <y/n>?"
410 L$=INKEY$:IF L$="" THEN 410
412 IF L$="n" OR L$="N" THEN 420
414 IF L$="r" OR L$="R" THEN 56
416 IF L$="Y" OR L$="y" GOSUB 652
418 GOTO 410
420 NEXT RN
422 CLS:PRINT@201,"FILE NOT FOUND":FOR X=1 TO 500:NEXT X:GOTO 56
424 CLS (4):PRINT@160,S$:PRINT UŞ
426 PRINT"      1> SORT BY "BA$
428 PRINT"      2> SORT BY "BB$
430 PRINT"      3> SORT BY "BC$
432 PRINT"      R> RETURN TO MAIN MENU"
434 PRINT U$: PRINT S$
436 SOUND 220,1
438 L$=INKEY$: IF L$="" THEN 438
440 IF L$="r" OR L$="R" THEN 56
442 L=VAL(L$)
444 IF L>0 AND L<4 THEN 446 ELSE 438
446 CLS: ON L GOTO 448,472,494
448 REM SORT
450 CLS4: PRINT@192,"           SORTING": PRINT@352,"         DO NOT DISTURB"
452 A2=REC
454 IF A2<=2 THEN 470
456 A3=0:FOR A1=1 TO A2-1
458 IF AŞ(A1) <= A$(Al+1) THEN 464
460 A3=A1+1
462 GOSUB 610
464 NEXT A1
466 A2=A3:GOTO 454
468 GOTO 454
470 GOTO 56
472 REM SORT
474 CLS4: PRINT@192,"           SORTING": PRINT@352,"         DO NOT DISTURB"
476 A2=REC
478 IF A2<=2 THEN 492
480 A3=0:FOR A1=1 T0 A2-1
482 IF B$(A1)<=B$(Al+1) THEN 488
484 A3=A1+1
486 GOSUB610
488 NEXTA1
490 A2=A3:GOTO478
492 GOTO56
494 REM SORT
496 CLS4: PRINT@192,"           SORTING": PRINT@352,"         DO NOT DISTURB"
498 A2=REC
500 IF A2<=2 THEN 514
502 A3=0:FOR A1=1 TO A2-1
504 IF C$(A1)<=C$(A1+1) THEN 510
506 A3=A1+1
508 GOSUB 610
510 NEXT A1
512 A2=A3:GOTO 500
514 GOTO 56



















374 L$=INKEY$:IF L$="" THEN 374
376 IF L$="n" OR L$="N" THEN 348
378 IF L$="y" OR L$="Y" GOSUB 652
380 IF L$="r" OR L$="R" THEN 56
